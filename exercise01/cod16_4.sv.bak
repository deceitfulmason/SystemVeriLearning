module cod16_4 (
    input  logic [15:0] X,
    output logic [3:0]  Y,
    output logic        GATE
);

    // Implementação simples e clara: varre do MSB para LSB e escolhe o primeiro '1'.
    always_comb begin
        // valores defaults
        Y = 4'd0;
        GATE = 1'b0;

        // procura do bit mais significativo ligado
        for (int i = 15; i >= 0; i--) begin
            if (X[i]) begin
                Y = i[3:0]; // converte índice para 4 bits
                GATE = 1'b1;
                // quando encontrar o MSB, sai do loop
                break;
            end
        end
    end

endmodule